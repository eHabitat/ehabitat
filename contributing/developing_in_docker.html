
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Developing in Docker &#8212; eHabitat</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=581237fb" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-codeautolink.css?v=b2176991" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=45766ed9" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=fb0c83f7"></script>
    <script src="../_static/doctools.js?v=a6d80eb4"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contributing/developing_in_docker';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
    <meta name="docbuild:last-update" content="True"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">eHabitat</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/XgenTimeSeries/xgen-timeseries" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/XgenTimeSeries/xgen-timeseries" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Developing in Docker</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="developing-in-docker">
<span id="id1"></span><h1>Developing in Docker<a class="headerlink" href="#developing-in-docker" title="Link to this heading">#</a></h1>
<p>We have provided a Dockerfile which helps for isolating build problems, and local development.
Install <a class="reference external" href="https://www.docker.com/">Docker</a> for your operating system, clone <a class="reference external" href="https://github.com/XGenTS-devs/XGenTS">this</a> repo. Docker will generate an environment with your local copy of <code class="docutils literal notranslate"><span class="pre">XGenTS</span></code> with all the packages in Dockerfile.</p>
<section id="container-sh-container-ps1">
<h2>container.sh &amp; container.ps1<a class="headerlink" href="#container-sh-container-ps1" title="Link to this heading">#</a></h2>
<p>Predefined docker commands can be run with a <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span></code> (on Linux and macOS)
and with <code class="docutils literal notranslate"><span class="pre">./scripts/container.ps1</span></code>. The scripts enable developers easily to call predefined docker commands.
Users can use one or multiple flags.</p>
<p>They are executed in the following order: clear-cache, build, test, docs, shell, notebook, lab</p>
<section id="for-linux-and-macos">
<h3>For Linux and macOS<a class="headerlink" href="#for-linux-and-macos" title="Link to this heading">#</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ ./scripts/container.sh --clear-cache
$ ./scripts/container.sh --build

$ ./scripts/container.sh --test
$ ./scripts/container.sh --docs
$ ./scripts/container.sh --shell
$ ./scripts/container.sh --notebook
$ ./scripts/container.sh --lab
</pre></div>
</div>
</section>
<section id="for-windows">
<h3>For Windows<a class="headerlink" href="#for-windows" title="Link to this heading">#</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ powershell.exe -File ./scripts/container.ps1 --clear-cache
$ powershell.exe -File ./scripts/container.ps1 --build

$ powershell.exe -File ./scripts/container.ps1 --test
$ powershell.exe -File ./scripts/container.ps1 --docs
$ powershell.exe -File ./scripts/container.ps1 --shell
$ powershell.exe -File ./scripts/container.ps1 --notebook
$ powershell.exe -File ./scripts/container.ps1 --lab
</pre></div>
</div>
</section>
</section>
<section id="testing-in-docker">
<h2>Testing in Docker<a class="headerlink" href="#testing-in-docker" title="Link to this heading">#</a></h2>
<p>Testing the code using docker consists of executing the same file(<code class="docutils literal notranslate"><span class="pre">./scripts/container.ps1</span></code>) 3 times (you may need root privileges to run it).</p>
<ol class="arabic simple">
<li><p>First run <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--clear-cache</span></code>.</p></li>
<li><p>Then run <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--build</span></code>. This starts a local docker image called <code class="docutils literal notranslate"><span class="pre">XGenTS</span></code>.</p></li>
<li><p>Finally, run the tests with <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--test</span></code>.</p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--build</span></code> command needs to be executed only once to build the docker image. If you have already built the docker image, and want to test your new changes, then it is a 2 step process.</p>
<ol class="arabic simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--clear-cache</span></code> because the cache generated locally is not valid for docker.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--test</span></code> to test with docker.</p></li>
</ol>
<p><strong>NOTE</strong>: If you run into errors due to <code class="docutils literal notranslate"><span class="pre">__pycache__</span></code> files (i.e. while testing in
docker after testing locally or installing with pip after testing with
docker), try running <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--clear-cache</span></code> before the errored
command.</p>
</section>
<section id="using-the-docker-image-interactively">
<h2>Using the Docker image interactively<a class="headerlink" href="#using-the-docker-image-interactively" title="Link to this heading">#</a></h2>
<p>Once the Docker image is built with <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--build</span></code>, interactive containers can also be run. Therefore, code can be edited and executed using the docker container, but modifying directly the working directory of the host machine.</p>
<section id="id2">
<h3>For Linux and macOS<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>To start a bash shell inside Docker, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ docker run --mount type=bind,source=&quot;$(pwd)&quot;,target=/opt/XGenTS/ -it XGenTS bash
</pre></div>
</div>
<p>Alternatively, to start a jupyter notebook, there are two steps, first run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ docker run --mount type=bind,source=&quot;$(pwd)&quot;,target=/opt/XGenTS/ --name jupyter-dock -it -d -p 8888:8888 XGenTS
$ docker exec jupyter-dock bash -c &quot;pip install jupyter&quot;
$ docker exec -it jupyter-dock bash -c &quot;jupyter notebook --ip 0.0.0.0 --no-browser --allow-root&quot;
</pre></div>
</div>
</section>
<section id="id3">
<h3>For Windows<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>For Windows, use %CD% on cmd.exe and $pwd.Path on powershell.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ docker run --mount type=bind,source=%CD%,target=/opt/XGenTS/ -it XGenTS bash
</pre></div>
</div>
<p>For running a jupyter notebook, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ docker run --mount type=bind,source=%CD%,target=/opt/XGenTS/ --name jupyter-dock -it -d -p 8888:8888 XGenTS
$ docker exec jupyter-dock bash -c &quot;pip install jupyter&quot;
$ docker exec -it jupyter-dock bash -c &quot;jupyter notebook --ip 0.0.0.0 --no-browser --allow-root&quot;
</pre></div>
</div>
<p>This will output something similar to <code class="docutils literal notranslate"><span class="pre">http://(&lt;docker</span> <span class="pre">container</span> <span class="pre">id&gt;</span> <span class="pre">or</span> <span class="pre">&lt;ip&gt;):8888/?token=&lt;token</span> <span class="pre">id&gt;</span></code>, and can be accessed at <code class="docutils literal notranslate"><span class="pre">http://localhost:8888/?token=&lt;token</span> <span class="pre">id&gt;</span></code>.</p>
</section>
</section>
<section id="building-documentation-with-docker">
<span id="building-doc-with-docker"></span><h2>Building documentation with Docker<a class="headerlink" href="#building-documentation-with-docker" title="Link to this heading">#</a></h2>
<p>The documentation can be built with Docker by running <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--docs</span></code>. The
<code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--build</span></code> needs to be executed once before running the doc build command.
The docker image contains by default all dependencies needed
for building the documentation. After having build the docs in the Docker
container, they can be checked at <code class="docutils literal notranslate"><span class="pre">docs/build</span></code> and viewed in the browser from <code class="docutils literal notranslate"><span class="pre">docs/build/index.html</span></code>.</p>
<p>To update any file, go to the specific file(<code class="docutils literal notranslate"><span class="pre">.md</span></code>, <code class="docutils literal notranslate"><span class="pre">.rst</span></code>, or <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code>) and make your changes. In order to check the results, you can either check the <a class="reference internal" href="sphinx_doc_build.html#preview-change"><span class="std std-ref">Previewing doc changes</span></a> or rebuild the docs with Docker. For the latter option, You need to only rebuild the docs, using the same command <code class="docutils literal notranslate"><span class="pre">./scripts/container.sh</span> <span class="pre">--docs</span></code>. The resulting docs will be saved in the <code class="docutils literal notranslate"><span class="pre">docs/build</span></code> directory as HTML files. Open your corresponding file and check the results. You wil also need to rebuild the docker image if extensions and dependencies were added or changed.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#container-sh-container-ps1">container.sh &amp; container.ps1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-linux-and-macos">For Linux and macOS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-windows">For Windows</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-in-docker">Testing in Docker</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-docker-image-interactively">Using the Docker image interactively</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">For Linux and macOS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">For Windows</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-documentation-with-docker">Building documentation with Docker</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
<div id="searchbox"></div></div>

  <div class="sidebar-secondary-item">
  
  <div class="tocsection editthispage">
    <a href="https://github.com/eHabitat-devs/eHabitat/edit/main/docs/source/contributing/developing_in_docker.md">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/contributing/developing_in_docker.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  

  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>


<script>
  $(document).ready(function () {
    const content = $('<div class="alert-danger">eHabitat docs will now be available at <a href="https://python.eHabitat.org">python.eHabitat.org</a>!</div>')
    $('#banner').append(content);
  })
</script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright 2023, eHabitat devs.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>